Lib.VehicleProperties=Lib.VehicleProperties or{}AddStateBagChangeHandler('lib:setVehicleProperties','',function(a,b,c)if not c or not GetEntityFromStateBagName then return end;while NetworkIsInTutorialSession()do Wait(0)end;local d=GetEntityFromStateBagName(a)Lib.Loop(GetCurrentResourceName(),function()d=GetEntityFromStateBagName(a)end,{timer=0,timeout=10000,condition=function()return d>0 end})if not DoesEntityExist(d)then return end;Lib.VehicleProperties.Set(GetCurrentResourceName(),d,c)Wait(200)if NetworkGetEntityOwner(d)==PlayerId()then Lib.VehicleProperties.Set(GetCurrentResourceName(),d,c)Entity(d).state:set('lib:setVehicleProperties',nil,true)end end)local e=GetGameBuildNumber()Lib.VehicleProperties.Get=function(f,g)if DoesEntityExist(g)then local h,i=GetVehicleColours(g)local j,k=GetVehicleExtraColours(g)local l=GetVehicleModColor_1(g)local m=GetVehicleModColor_2(g)if GetIsVehiclePrimaryColourCustom(g)then h={GetVehicleCustomPrimaryColour(g)}end;if GetIsVehicleSecondaryColourCustom(g)then i={GetVehicleCustomSecondaryColour(g)}end;local n={}for o=1,15 do if DoesExtraExist(g,o)then n[o]=IsVehicleExtraTurnedOn(g,o)and 0 or 1 end end;local p=GetVehicleLiveryCount(g)local q=GetVehicleLivery(g)if p==-1 or q==-1 then q=GetVehicleMod(g,48)end;local r={windows={},doors={},tyres={}}local s=0;for o=0,7 do RollUpWindow(g,o)if not IsVehicleWindowIntact(g,o)then s=s+1;r.windows[s]=o end end;local t=0;for o=0,5 do if IsVehicleDoorDamaged(g,o)then t=t+1;r.doors[t]=o end end;for o=0,7 do if IsVehicleTyreBurst(g,o,false)then r.tyres[o]=IsVehicleTyreBurst(g,o,true)and 2 or 1 end end;local u={}for o=0,3 do u[o+1]=IsVehicleNeonLightEnabled(g,o)end;return{model=GetEntityModel(g),plate=GetVehicleNumberPlateText(g),plateIndex=GetVehicleNumberPlateTextIndex(g),bodyHealth=math.floor(GetVehicleBodyHealth(g)+0.5),engineHealth=math.floor(GetVehicleEngineHealth(g)+0.5),tankHealth=math.floor(GetVehiclePetrolTankHealth(g)+0.5),fuelLevel=math.floor(GetVehicleFuelLevel(g)+0.5),oilLevel=math.floor(GetVehicleOilLevel(g)+0.5),dirtLevel=math.floor(GetVehicleDirtLevel(g)+0.5),paintType1=l,paintType2=m,color1=h,color2=i,pearlescentColor=j,interiorColor=GetVehicleInteriorColor(g),dashboardColor=GetVehicleDashboardColour(g),wheelColor=k,wheelWidth=GetVehicleWheelWidth(g),wheelSize=GetVehicleWheelSize(g),wheels=GetVehicleWheelType(g),windowTint=GetVehicleWindowTint(g),xenonColor=GetVehicleXenonLightsColor(g),neonEnabled=u,neonColor={GetVehicleNeonLightsColour(g)},extras=n,tyreSmokeColor={GetVehicleTyreSmokeColor(g)},modSpoilers=GetVehicleMod(g,0),modFrontBumper=GetVehicleMod(g,1),modRearBumper=GetVehicleMod(g,2),modSideSkirt=GetVehicleMod(g,3),modExhaust=GetVehicleMod(g,4),modFrame=GetVehicleMod(g,5),modGrille=GetVehicleMod(g,6),modHood=GetVehicleMod(g,7),modFender=GetVehicleMod(g,8),modRightFender=GetVehicleMod(g,9),modRoof=GetVehicleMod(g,10),modEngine=GetVehicleMod(g,11),modBrakes=GetVehicleMod(g,12),modTransmission=GetVehicleMod(g,13),modHorns=GetVehicleMod(g,14),modSuspension=GetVehicleMod(g,15),modArmor=GetVehicleMod(g,16),modNitrous=GetVehicleMod(g,17),modTurbo=IsToggleModOn(g,18),modSubwoofer=GetVehicleMod(g,19),modSmokeEnabled=IsToggleModOn(g,20),modHydraulics=IsToggleModOn(g,21),modXenon=IsToggleModOn(g,22),modFrontWheels=GetVehicleMod(g,23),modBackWheels=GetVehicleMod(g,24),modCustomTiresF=GetVehicleModVariation(g,23),modCustomTiresR=GetVehicleModVariation(g,24),modPlateHolder=GetVehicleMod(g,25),modVanityPlate=GetVehicleMod(g,26),modTrimA=GetVehicleMod(g,27),modOrnaments=GetVehicleMod(g,28),modDashboard=GetVehicleMod(g,29),modDial=GetVehicleMod(g,30),modDoorSpeaker=GetVehicleMod(g,31),modSeats=GetVehicleMod(g,32),modSteeringWheel=GetVehicleMod(g,33),modShifterLeavers=GetVehicleMod(g,34),modAPlate=GetVehicleMod(g,35),modSpeakers=GetVehicleMod(g,36),modTrunk=GetVehicleMod(g,37),modHydrolic=GetVehicleMod(g,38),modEngineBlock=GetVehicleMod(g,39),modAirFilter=GetVehicleMod(g,40),modStruts=GetVehicleMod(g,41),modArchCover=GetVehicleMod(g,42),modAerials=GetVehicleMod(g,43),modTrimB=GetVehicleMod(g,44),modTank=GetVehicleMod(g,45),modWindows=GetVehicleMod(g,46),modDoorR=GetVehicleMod(g,47),modLivery=q,modRoofLivery=GetVehicleRoofLivery(g),modLightbar=GetVehicleMod(g,49),windows=r.windows,doors=r.doors,tyres=r.tyres,bulletProofTyres=GetVehicleTyresCanBurst(g),driftTyres=e>=2372 and GetDriftTyresEnabled(g)}end end;Lib.VehicleProperties.Set=function(f,g,v,w)print(f,g,v,w)if not DoesEntityExist(g)then error(("Unable to set vehicle properties for '%s' (entity does not exist)"):format(g))end;local h,i=GetVehicleColours(g)local j,k=GetVehicleExtraColours(g)SetVehicleModKit(g,0)if v.extras then for x,y in pairs(v.extras)do SetVehicleExtra(g,tonumber(x),y==1)end end;if v.plate then SetVehicleNumberPlateText(g,v.plate)end;if v.plateIndex then SetVehicleNumberPlateTextIndex(g,v.plateIndex)end;if v.bodyHealth then SetVehicleBodyHealth(g,v.bodyHealth+0.0)end;if v.engineHealth then SetVehicleEngineHealth(g,v.engineHealth+0.0)end;if v.tankHealth then SetVehiclePetrolTankHealth(g,v.tankHealth+0.0)end;if v.fuelLevel then SetVehicleFuelLevel(g,v.fuelLevel+0.0)end;if v.oilLevel then SetVehicleOilLevel(g,v.oilLevel+0.0)end;if v.dirtLevel then SetVehicleDirtLevel(g,v.dirtLevel+0.0)end;if v.color1 then if type(v.color1)=='number'then ClearVehicleCustomPrimaryColour(g)SetVehicleColours(g,v.color1,i)else if v.paintType1 then SetVehicleModColor_1(g,v.paintType1,h,j)end;SetVehicleCustomPrimaryColour(g,v.color1[1],v.color1[2],v.color1[3])end end;if v.color2 then if type(v.color2)=='number'then ClearVehicleCustomSecondaryColour(g)SetVehicleColours(g,v.color1 or h,v.color2)else if v.paintType2 then SetVehicleModColor_2(g,v.paintType2,i)end;SetVehicleCustomSecondaryColour(g,v.color2[1],v.color2[2],v.color2[3])end end;if v.pearlescentColor or v.wheelColor then SetVehicleExtraColours(g,v.pearlescentColor or j,v.wheelColor or k)end;if v.interiorColor then SetVehicleInteriorColor(g,v.interiorColor)end;if v.dashboardColor then SetVehicleDashboardColor(g,v.dashboardColor)end;if v.wheels then SetVehicleWheelType(g,v.wheels)end;if v.wheelSize then SetVehicleWheelSize(g,v.wheelSize)end;if v.wheelWidth then SetVehicleWheelWidth(g,v.wheelWidth)end;if v.windowTint then SetVehicleWindowTint(g,v.windowTint)end;if v.neonEnabled then for o=1,#v.neonEnabled do SetVehicleNeonLightEnabled(g,o-1,v.neonEnabled[o])end end;if v.windows then for o=1,#v.windows do RemoveVehicleWindow(g,v.windows[o])end end;if v.doors then for o=1,#v.doors do SetVehicleDoorBroken(g,v.doors[o],true)end end;if v.tyres then for z,A in pairs(v.tyres)do SetVehicleTyreBurst(g,tonumber(z),A==2,1000.0)end end;if v.neonColor then SetVehicleNeonLightsColour(g,v.neonColor[1],v.neonColor[2],v.neonColor[3])end;if v.modSmokeEnabled~=nil then ToggleVehicleMod(g,20,v.modSmokeEnabled)end;if v.tyreSmokeColor then SetVehicleTyreSmokeColor(g,v.tyreSmokeColor[1],v.tyreSmokeColor[2],v.tyreSmokeColor[3])end;if v.modSpoilers then SetVehicleMod(g,0,v.modSpoilers,false)end;if v.modFrontBumper then SetVehicleMod(g,1,v.modFrontBumper,false)end;if v.modRearBumper then SetVehicleMod(g,2,v.modRearBumper,false)end;if v.modSideSkirt then SetVehicleMod(g,3,v.modSideSkirt,false)end;if v.modExhaust then SetVehicleMod(g,4,v.modExhaust,false)end;if v.modFrame then SetVehicleMod(g,5,v.modFrame,false)end;if v.modGrille then SetVehicleMod(g,6,v.modGrille,false)end;if v.modHood then SetVehicleMod(g,7,v.modHood,false)end;if v.modFender then SetVehicleMod(g,8,v.modFender,false)end;if v.modRightFender then SetVehicleMod(g,9,v.modRightFender,false)end;if v.modRoof then SetVehicleMod(g,10,v.modRoof,false)end;if v.modEngine then SetVehicleMod(g,11,v.modEngine,false)end;if v.modBrakes then SetVehicleMod(g,12,v.modBrakes,false)end;if v.modTransmission then SetVehicleMod(g,13,v.modTransmission,false)end;if v.modHorns then SetVehicleMod(g,14,v.modHorns,false)end;if v.modSuspension then SetVehicleMod(g,15,v.modSuspension,false)end;if v.modArmor then SetVehicleMod(g,16,v.modArmor,false)end;if v.modNitrous then SetVehicleMod(g,17,v.modNitrous,false)end;if v.modTurbo~=nil then ToggleVehicleMod(g,18,v.modTurbo)end;if v.modSubwoofer~=nil then ToggleVehicleMod(g,19,v.modSubwoofer)end;if v.modHydraulics~=nil then ToggleVehicleMod(g,21,v.modHydraulics)end;if v.modXenon~=nil then ToggleVehicleMod(g,22,v.modXenon)end;if v.xenonColor then SetVehicleXenonLightsColor(g,v.xenonColor)end;if v.modFrontWheels then SetVehicleMod(g,23,v.modFrontWheels,v.modCustomTiresF)end;if v.modBackWheels then SetVehicleMod(g,24,v.modBackWheels,v.modCustomTiresR)end;if v.modPlateHolder then SetVehicleMod(g,25,v.modPlateHolder,false)end;if v.modVanityPlate then SetVehicleMod(g,26,v.modVanityPlate,false)end;if v.modTrimA then SetVehicleMod(g,27,v.modTrimA,false)end;if v.modOrnaments then SetVehicleMod(g,28,v.modOrnaments,false)end;if v.modDashboard then SetVehicleMod(g,29,v.modDashboard,false)end;if v.modDial then SetVehicleMod(g,30,v.modDial,false)end;if v.modDoorSpeaker then SetVehicleMod(g,31,v.modDoorSpeaker,false)end;if v.modSeats then SetVehicleMod(g,32,v.modSeats,false)end;if v.modSteeringWheel then SetVehicleMod(g,33,v.modSteeringWheel,false)end;if v.modShifterLeavers then SetVehicleMod(g,34,v.modShifterLeavers,false)end;if v.modAPlate then SetVehicleMod(g,35,v.modAPlate,false)end;if v.modSpeakers then SetVehicleMod(g,36,v.modSpeakers,false)end;if v.modTrunk then SetVehicleMod(g,37,v.modTrunk,false)end;if v.modHydrolic then SetVehicleMod(g,38,v.modHydrolic,false)end;if v.modEngineBlock then SetVehicleMod(g,39,v.modEngineBlock,false)end;if v.modAirFilter then SetVehicleMod(g,40,v.modAirFilter,false)end;if v.modStruts then SetVehicleMod(g,41,v.modStruts,false)end;if v.modArchCover then SetVehicleMod(g,42,v.modArchCover,false)end;if v.modAerials then SetVehicleMod(g,43,v.modAerials,false)end;if v.modTrimB then SetVehicleMod(g,44,v.modTrimB,false)end;if v.modTank then SetVehicleMod(g,45,v.modTank,false)end;if v.modWindows then SetVehicleMod(g,46,v.modWindows,false)end;if v.modDoorR then SetVehicleMod(g,47,v.modDoorR,false)end;if v.modLivery then SetVehicleMod(g,48,v.modLivery,false)SetVehicleLivery(g,v.modLivery)end;if v.modRoofLivery then SetVehicleRoofLivery(g,v.modRoofLivery)end;if v.modLightbar then SetVehicleMod(g,49,v.modLightbar,false)end;if v.bulletProofTyres~=nil then SetVehicleTyresCanBurst(g,v.bulletProofTyres)end;if e>=2372 and v.driftTyres then SetDriftTyresEnabled(g,true)end;if w then SetVehicleFixed(g)end;return not NetworkGetEntityIsNetworked(g)or NetworkGetEntityOwner(g)==PlayerPedId()end