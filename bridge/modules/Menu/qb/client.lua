if not IsMissing("Menu","qb-menu")then return end;local a=exports["qb-menu"]AddStore("MENUFUNCTIONS")local b;RegisterNetEvent('lib:TriggerMenuEvent',function(c)local d=c.args or{}local e=c.resource;if c.id=="goBack"then if not b then return print("No previous menu to go back to.")end;local f=b[#b]b[#b]=nil;return a:openMenu(f)end;for g=1,#(STORE.MENUFUNCTIONS[e]or{})do local h=STORE.MENUFUNCTIONS[e][g]if h.id==c.id then h.func(d)break end end end)local i=function(j,h)local k={}k[#k+1]={header=h.title,isMenuHeader=true}for g=1,#(h.options or{})do local l=h.options[g]local m=function(c)if h.goBack then b[#b+1]=k else b={k}end;if l.serverEvent then TriggerServerEvent(l.serverEvent,c)end;if l.event then TriggerEvent(l.event,c)end;if l.onSelect then l.onSelect(c)end end;local n=("%s:%s:%d"):format(h.id,l.title,g)AddToStore("MENUFUNCTIONS",j,{id=n,func=m})local o={header=l.title,txt=l.description,icon=l.icon,disabled=l.disabled or l.readOnly,params={isServer=false,event='lib:TriggerMenuEvent',args={id=n,resource=j,args=l.args}}}k[#k+1]=o end;if h.goBack then k[#k+1]={header="Go back",icon="fas fa-arrow-left",params={isServer=false,event='lib:TriggerMenuEvent',args={id="goBack",resource=j,args={}}}}end;return k end;Lib.Menu=function(j,h)if not(h.id and h.title)then return print("Menu requires an id and title.")end;a:openMenu(i(j,h))end