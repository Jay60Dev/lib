local a,b=Shared.UseResource()if not a then return end;Server.Inventory=Server.Inventory or{}local c=LoadResourceFile("qb-inventory","fxmanifest.lua")local d=c:match("ui_page%s+'(html/[^']+)'")=="html/index.html"and"new"or"old"local e={new={file="config/config.lua",maxWeight="MaxWeight%s*=%s*(%d+)",maxSlots="MaxSlots%s*=%s*(%d+)"},old={file="config.lua",maxWeight="MaxInventoryWeight%s*=%s*(%d+)",maxSlots="MaxInventorySlots%s*=%s*(%d+)"}}local f;local g;Server.Inventory.ConvertItemsMetdata=function(h,i)Shared.Print(h,i)local j={}i=Shared.Table.RemoveNilValues(h,i)for k=1,#i do local l=i[k]j[k]={name=l.name,count=l.amount,metadata=l.info,amount=l.count,info=l.metadata or{},label=l.label or Server.Inventory.GetLabel(h,l.name),slot=l.slot,weight=l.weight or Server.Inventory.GetItemWeight(h,l.name)}end;return j end;Server.Inventory.GetAllItems=function(h,m)local n=Core.Functions.GetPlayer(m)if not n then return{},"Failed to get player"end;local o=n.PlayerData;if not o then return{},"Failed to get PlayerData"end;local i=o.items;if not i then return{}end;return Server.Inventory.ConvertItemsMetdata(h,i)end;Server.Inventory.GetMaxSlots=function()if g then return g end;local p=e[d]local q=LoadResourceFile("qb-inventory",p.file)if not q then print("Failed to load config file to get max slots")return 1000000 end;local r=q:match(p.maxSlots)f=q:match(p.maxWeight)if not r then print("Failed to get max slots from config file")end;g=tonumber(r)or 1000000;return g end;Server.Inventory.GetMaxWeightForPlayer=function(h,m)if f then return f end;local p=e[d]local q=LoadResourceFile("qb-inventory",p.file)if not q then print("Failed to load config file to get max weight")return 1000000 end;local s=q:match(p.maxWeight)g=q:match(p.maxSlots)if not s then print("Failed to get max weight from config file")end;f=tonumber(s)or 1000000;return f end;Server.Inventory.GetItemWeight=function(h,t)local l=Core.Shared.Items[t]return l and l.weight or 0 end;Server.Inventory.GetLabel=function(h,t)local l=Core.Shared.Items[t]return l and l.label or t end;Server.Inventory.AddItem=function(h,m,l,u,v,w)u=u or 1;local x=Server.Inventory.CanCarry(h,m,l,u)if not x then if not Config.DropItemsWhenInventoryFull.enabled then print("QBCore does not provide an export for creating a drop")return false end;return false end;return b:AddItem(m,l,u,w,v)end;Server.Inventory.RemoveItem=function(h,m,l,u,v,w)u=u or 1;if not v then local y=b:RemoveItem(m,l,u,w)return y else return Server.Inventory.GetItemsToRemoveForInventoriesThatDontSupportRemovalWithMetadata(h,m,l,u,v)end end