local a={"ox_lib","qb-core","qbx_core","es_extended","ND_core","ox_core"}Config=Config or{}DevelopmentMode=GetConvar("lib:DevelopmentMode","false")=="true"or Config.DevelopmentMode;if DevelopmentMode then print("^4Development mode enabled^7")end;Client={}Server={}Shared={}STORE={}Resources={}IsServer=IsDuplicityVersion()==1;IsClient=not IsServer;NUILoaded=false;local b={}local c=GetGameTimer()WaitForNUI=function()print("NUI not loaded, and this function hasnt had enough time to generate.")end;Config.ForceResource=Config.ForceResource or{}Config.RenamedResources=Config.RenamedResources or{}for d,e in pairs(Config.RenamedResources)do if type(e)=="boolean"then Config.RenamedResources[d]=d end end;Shared.GetResourceTitle=function(f,g)return Config.RenamedResources[f]or g end;Shared.GetResource=function(f,h)if h then local i=Resources[h]if i=="^1NOT FOUND^7"then return false end;return i end;return Resources end;if IsClient then RegisterNUICallback("loaded",function(j,k)NUILoaded=true;k({})end)WaitForNUI=function()local l=GetGameTimer()if NUILoaded then return true end;if l-c>10000 then return NUILoaded end;while not NUILoaded do Wait(0)end;return NUILoaded end end;local m=Shared.GetResourceTitle(nil,"ox_lib")if GetResourceState(m)=="started"then load(LoadResourceFile(m,"init.lua"))()end;local n=function(i)if i==GetCurrentResourceName()then if Client.DrawText then Client.DrawText()end end;if IsClient then SendNUIMessage({action="stopResource",resource=i})end;if i==GetCurrentResourceName()then for d in pairs(STORE)do local k=b[d]for f in pairs(STORE[d])do for o=1,#STORE[d][f]do local p=STORE[d][f][o]if type(k)=="function"then k(p)end end end end end;for d in pairs(STORE)do local q=STORE[d][i]if q then local k=b[d]for o=1,#q do local p=q[o]if type(k)=="function"then k(p)end end;STORE[d][i]=nil end end end;RegisterNetEvent('onResourceStop',n)AddStore=function(d,k)STORE[d]={}b[d]=k end;AddToStore=function(r,i,j)if not r then print("STORE is required, got nil")return end;if not i then print("RESOURCE is required, got nil for store:",r)print(debug.traceback())return end;if not GetResourceState(i)=="started"then return print(("RESOURCE %s is not started"):format(i))end;if not STORE[r]then return print(("STORE %s does not exist"):format(r))end;STORE[r][i]=STORE[r][i]or{}STORE[r][i][#STORE[r][i]+1]=j end;Shared.LookupTable=function(f,s,e)local t=LoadResourceFile(f,s)local u=json.decode(t)if not u then return print(("Failed to decode json file %s"):format(s))end;if not e then return u end;if type(e)=="table"then local v={}for o=1,#e do local d=type(e[o])=="string"and e[o]:lower()or e[o]v[d]=u[d]end;return v end;e=type(e)=="string"and e:lower()or e;local v=u[e]collectgarbage("collect")return v end;local w={["qb-core"]={"qbx_core"}}local x={["codem-inventory"]=true}Shared.UseResource=function(f)local y=debug.getinfo(2,"S").short_src;local z={}for o in string.gmatch(y,"([^/]+)")do z[#z+1]=o end;local h=z[#z-2]if h=="modules"then print(y)end;local i=z[#z-1]f=Config.RenamedResources[i]or i;if x[i]then print(("%s is not fully supported yet. we are working on it"):format(f))if not Shared.DevelopmentMode()then return false end end;if Resources[h]and Resources[h]~="^1NOT FOUND^7"then return false end;Resources[h]=Resources[h]or"^1NOT FOUND^7"for d,e in pairs(w)do if f==d then for o=1,#e do local A=e[o]if GetResourceState(A)~="missing"then return false end end end end;if Config.ForceResource[h]then local B=Config.ForceResource[h]==f;if not B then return false end end;local C=GetResourceState(f)~="missing"Resources[h]=C and f or Resources[h]return C,C and exports[f]or nil,f end;Shared.MissingResource=function()local D=debug.getinfo(2,"Sln")local y=D.short_src;local E=D.name;local z={}for o in string.gmatch(y,"([^/]+)")do z[#z+1]=o end;local h=z[#z-1]print(("No function found for %s in %s. This usually happens because the resource was not found. Do you have a valid resource for this module?\nIf so, does it have a function for %s"):format(E,h,E))end;Shared.CheckNeededModules=function(f,j)j=j or{}for F,G in pairs(j)do if F=="server"and not IsClient or F=="client"and IsClient or F=="shared"then for o=1,#G do if not Shared.GetResource(f,G[o])then print(("^5%s^7 needs ^1%s^7 resource to work.\n^3Please ensure you have youre %s resource set up, and its supported. Expect errors until this is resolved.^7"):format(f,G[o],G[o]))end end end end end